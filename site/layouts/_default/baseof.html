<!DOCTYPE html>
<html lang="{{ $.Site.Language.Lang }}">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>
            {{- if .IsHome -}}
                {{ $.Site.Title }} chat &amp; conferencing
            {{- else -}}
                {{ $.Site.Title }} - {{ .Title }}
            {{- end -}}
        </title>
        
        {{- $description := "" -}}
        {{- if .IsHome -}}
            {{- $description = "Pearmo is a chat and conferencing platform with no sign up." -}}
        {{- else if (isset .Params "description") -}}
            {{- $description = .Param "description" -}}
        {{- end -}}
    
        {{ if ne $description "" }}
        <meta name="description" content="{{ $description }}">
        {{- end }}

        <!-- Process CSS files with PostCSS -->
        <!-- More details: https://gohugo.io/hugo-pipes/postcss/ -->
        {{ $style := resources.Get "css/main.css" | resources.PostCSS }}
        <link rel="stylesheet" href="{{ $style.RelPermalink }}">

        {{/* // Remove js processing
        <!-- Process JavaScript files with ESBuild -->
        <!-- More details: https://gohugo.io/hugo-pipes/js/ -->
        {{ $built := resources.Get "js/index.js" | js.Build "main.js" }}
        <script src="{{ $built.RelPermalink }}" defer></script>
        */}}

        {{ block "page-head" . }}{{ end }}

        {{- if eq hugo.Environment "production" -}}
            {{ partial "umami" . }}
        {{- end }}
    </head>

    <body>
        {{- block "nav" . }}
        <header class="navbar">
            <section class="navbar-section">
                <a href="{{ `/` | relURL }}" class="navbar-brand mr-2 main-brand">
                <img src="{{ `/img/pearmo-logo-color.png` | relURL }}" alt="Pearmo logo">
                <h5>Pearmo</h5>
                </a>

                {{- $navpages := where .Site.Pages.ByWeight "Title" "!=" $.Site.Title }}
                {{ range $navpages }}
                <a href="{{ .RelPermalink }}" class="btn btn-link">{{ .Title }}</a>
                {{- end }}
            </section>
        </header>
        {{- end }}

        {{ block "header" . }}{{ partial "header" . }}{{ end }}

        {{- block "main" . }}
        <main class="container grid-lg">{{- block "main-content" . }}{{ end -}}</main>
        {{- end }}

        {{ block "footer" . }}{{ partial "footer" . }}{{ end }}
    </body>
</html>